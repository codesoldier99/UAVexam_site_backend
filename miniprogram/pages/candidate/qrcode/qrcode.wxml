<view class="container">
  <!-- å¤´éƒ¨ä¿¡æ¯ -->
  <view class="header-info card">
    <view class="user-info">
      <view class="avatar">ğŸ‘¨â€ğŸ“</view>
      <view class="user-details">
        <view class="name">{{candidateInfo.name}}</view>
        <view class="id-number">{{candidateInfo.id_number}}</view>
      </view>
    </view>
    <view class="logout-btn" bindtap="logout">
      <text class="logout-icon">âš™ï¸</text>
    </view>
  </view>

  <!-- äºŒç»´ç åŒºåŸŸ -->
  <view class="qrcode-section card">
    <view class="section-title">æˆ‘çš„èº«ä»½äºŒç»´ç </view>
    
    <view wx:if="{{isLoading}}" class="loading">
      <view class="loading-icon">â³</view>
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>

    <view wx:elif="{{nextSchedule && qrCodeUrl}}" class="qrcode-content">
      <!-- è€ƒè¯•ä¿¡æ¯ -->
      <view class="exam-info">
        <view class="exam-title">{{nextSchedule.activity_name || nextSchedule.exam_product_name}}</view>
        <view class="exam-time">{{nextSchedule.exam_time}}</view>
        <view class="exam-venue">{{nextSchedule.venue_name}}</view>
      </view>

      <!-- äºŒç»´ç  -->
      <view class="qrcode-wrapper">
        <image 
          class="qrcode-image" 
          src="{{qrCodeUrl}}" 
          mode="aspectFit"
          show-menu-by-longpress="{{false}}"
        />
      </view>

      <!-- äºŒç»´ç ä¿¡æ¯ -->
      <view class="qrcode-info">
        <view class="info-item">
          <text class="info-label">çŠ¶æ€ï¼š</text>
          <text class="info-value status-waiting">{{nextSchedule.status}}</text>
        </view>
        <view wx:if="{{qrData.valid_until}}" class="info-item">
          <text class="info-label">æœ‰æ•ˆæœŸè‡³ï¼š</text>
          <text class="info-value">{{qrData.valid_until}}</text>
        </view>
      </view>

      <!-- ä½¿ç”¨è¯´æ˜ -->
      <view class="usage-tips">
        <view class="tip-title">ä½¿ç”¨è¯´æ˜</view>
        <view class="tip-item">1. è¯·å‘è€ƒåŠ¡äººå‘˜å‡ºç¤ºæ­¤äºŒç»´ç </view>
        <view class="tip-item">2. äºŒç»´ç ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œè¯·ä¿æŒæœ€æ–°</view>
        <view class="tip-item">3. å¦‚æ— æ³•æ‰«æï¼Œè¯·è”ç³»ç°åœºå·¥ä½œäººå‘˜</view>
      </view>
    </view>

    <view wx:else class="empty-state">
      <view class="empty-icon">ğŸ“‹</view>
      <view class="empty-title">æš‚æ— å¯ç”¨äºŒç»´ç </view>
      <view class="empty-desc">
        <text wx:if="{{!nextSchedule}}">æ‚¨å½“å‰æ²¡æœ‰å¾…è¿›è¡Œçš„è€ƒè¯•å®‰æ’</text>
        <text wx:else>äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</text>
      </view>
    </view>

    <!-- åˆ·æ–°æŒ‰é’® -->
    <view class="refresh-section">
      <button 
        class="btn-secondary refresh-btn" 
        bindtap="refreshQRCode"
        disabled="{{refreshing}}"
      >
        <text class="refresh-icon">ğŸ”„</text>
        {{refreshing ? 'åˆ·æ–°ä¸­...' : 'æ‰‹åŠ¨åˆ·æ–°'}}
      </button>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="quick-actions">
    <navigator url="/pages/candidate/schedule/schedule" class="action-item">
      <view class="action-icon">ğŸ“…</view>
      <view class="action-text">æˆ‘çš„æ—¥ç¨‹</view>
    </navigator>
    <navigator url="/pages/public/dashboard/dashboard" class="action-item">
      <view class="action-icon">ğŸ“Š</view>
      <view class="action-text">è€ƒåœºçœ‹æ¿</view>
    </navigator>
  </view>
</view>