# ğŸ“š è€ƒè¯•ç³»ç»Ÿåç«¯APIè¯¦ç»†æ¥å£è¯´æ˜ä¹¦

## ğŸ  é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: è€ƒè¯•ç³»ç»Ÿåç«¯API  
**ç‰ˆæœ¬**: 1.0.0  
**GitHubä»“åº“**: https://github.com/codesoldier99/UAVexam_site_backend.git  
**éƒ¨ç½²åœ°å€**: http://106.52.214.54/  
**æœ€åæ›´æ–°**: 2025-08-04

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è€ƒè¯•ç®¡ç†ç³»ç»Ÿåç«¯APIï¼Œä¸“ä¸ºæ— äººæœºé©¾é©¶å‘˜ç­‰å„ç±»æŠ€èƒ½è€ƒè¯•ç®¡ç†è€Œè®¾è®¡ã€‚ç³»ç»Ÿæ”¯æŒæœºæ„ç®¡ç†ã€è€ƒç”Ÿç®¡ç†ã€æ’æœŸç®¡ç†ã€äºŒç»´ç ç­¾åˆ°ã€æ‰¹é‡æ“ä½œã€æƒé™æ§åˆ¶ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œå¹¶æä¾›å¾®ä¿¡å°ç¨‹åºæ¥å£æ”¯æŒã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ”— é‡è¦é“¾æ¥
- **Base URL**: `http://106.52.214.54/`
- **Swagger APIæ–‡æ¡£**: `http://106.52.214.54/docs`
- **ReDocæ–‡æ¡£**: `http://106.52.214.54/redoc`
- **æœ¬åœ°å¼€å‘**: `http://localhost:8000/`

### ğŸ¯ æŠ€æœ¯æ ˆ
- **åç«¯æ¡†æ¶**: FastAPI
- **æ•°æ®åº“**: PostgreSQL/MySQL
- **ORM**: SQLAlchemy
- **è®¤è¯**: JWT Bearer Token
- **æ–‡æ¡£**: Swagger/OpenAPI 3.0
- **éƒ¨ç½²**: Docker + Docker Compose

### ğŸ“‹ è®¤è¯æ–¹å¼
æ‰€æœ‰éœ€è¦è®¤è¯çš„APIéƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«Bearer Tokenï¼š
```http
Authorization: Bearer <your_jwt_token>
```

### ğŸ“Š é€šç”¨å“åº”æ ¼å¼
```json
{
  "message": "æ“ä½œæè¿°ä¿¡æ¯",
  "data": {},
  "pagination": {
    "page": 1,
    "size": 10,
    "total": 100,
    "pages": 10
  },
  "timestamp": "2025-08-04T10:00:00Z"
}
```

### ğŸ”§ é€šç”¨æŸ¥è¯¢å‚æ•°
- `page`: é¡µç ï¼Œé»˜è®¤1
- `size`: æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§100
- `search`: æœç´¢å…³é”®è¯
- `status`: çŠ¶æ€ç­›é€‰
- `start_date`: å¼€å§‹æ—¥æœŸ
- `end_date`: ç»“æŸæ—¥æœŸ

---

## ğŸ“ APIæ¥å£è¯¦ç»†è¯´æ˜

### 1. ğŸ  ç³»ç»ŸåŸºç¡€æ¥å£

#### 1.1 æ ¹è·¯å¾„ - ç³»ç»Ÿæ¬¢è¿ä¿¡æ¯
```http
GET /
```

**åŠŸèƒ½æè¿°**: è·å–ç³»ç»ŸåŸºæœ¬ä¿¡æ¯å’Œæ¬¢è¿æ¶ˆæ¯

**è¯·æ±‚å‚æ•°**: æ— 

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ¬¢è¿ä½¿ç”¨è€ƒè¯•ç³»ç»Ÿåç«¯API - ç®€åŒ–æµ‹è¯•ç‰ˆæœ¬",
  "version": "1.0.0-test",
  "service": "è€ƒè¯•ç®¡ç†ç³»ç»Ÿ",
  "timestamp": "2025-08-04T10:00:00Z"
}
```

**åº”ç”¨åœºæ™¯**: ç³»ç»Ÿè¿é€šæ€§æ£€æŸ¥ã€ç‰ˆæœ¬ä¿¡æ¯è·å–

---

#### 1.2 å¥åº·æ£€æŸ¥ - ç³»ç»ŸçŠ¶æ€ç›‘æ§
```http
GET /health
```

**åŠŸèƒ½æè¿°**: æ£€æŸ¥ç³»ç»Ÿå¥åº·çŠ¶æ€ï¼ŒåŒ…æ‹¬æ•°æ®åº“è¿æ¥ã€æœåŠ¡çŠ¶æ€ç­‰

**è¯·æ±‚å‚æ•°**: æ— 

**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "healthy",
  "timestamp": "2025-08-04T10:00:00Z",
  "version": "1.0.0",
  "service": "è€ƒè¯•ç³»ç»Ÿåç«¯API",
  "components": {
    "database": "healthy",
    "cache": "healthy",
    "storage": "healthy"
  },
  "uptime": "2d 5h 30m"
}
```

**åº”ç”¨åœºæ™¯**: è¿ç»´ç›‘æ§ã€è´Ÿè½½å‡è¡¡å¥åº·æ£€æŸ¥

---

#### 1.3 æµ‹è¯•æ¥å£ - APIè¿é€šæ€§éªŒè¯
```http
GET /test
```

**åŠŸèƒ½æè¿°**: ç®€å•çš„è¿é€šæ€§æµ‹è¯•æ¥å£

**è¯·æ±‚å‚æ•°**: æ— 

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æµ‹è¯•æˆåŠŸ",
  "status": "ok",
  "timestamp": "2025-08-04T10:00:00Z",
  "request_id": "req_12345",
  "server_info": {
    "hostname": "api-server-01",
    "environment": "production"
  }
}
```

**åº”ç”¨åœºæ™¯**: ç½‘ç»œè¿é€šæ€§æµ‹è¯•ã€APIå¯ç”¨æ€§éªŒè¯

---

### 2. ğŸ” è®¤è¯æˆæƒæ¥å£

#### 2.1 ç”¨æˆ·ç™»å½•
```http
POST /login
```

**åŠŸèƒ½æè¿°**: ç”¨æˆ·ç™»å½•è®¤è¯ï¼Œè·å–è®¿é—®ä»¤ç‰Œ

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "admin",
  "password": "password123"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer",
  "expires_in": 3600,
  "user": {
    "id": 1,
    "username": "admin",
    "email": "admin@example.com",
    "role": "admin",
    "status": "active",
    "last_login": "2025-08-04T10:00:00Z",
    "permissions": ["read", "write", "delete"]
  }
}
```

**é”™è¯¯å“åº”**:
```json
{
  "detail": "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯",
  "error_code": "INVALID_CREDENTIALS",
  "timestamp": "2025-08-04T10:00:00Z"
}
```

**åº”ç”¨åœºæ™¯**: ç³»ç»Ÿç™»å½•ã€è·å–è®¿é—®æƒé™

---

#### 2.2 è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
```http
GET /me
```

**åŠŸèƒ½æè¿°**: è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯

**è¯·æ±‚å¤´**:
```http
Authorization: Bearer <token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "id": 1,
  "username": "admin",
  "email": "admin@example.com",
  "role": "admin",
  "status": "active",
  "institution_id": null,
  "permissions": ["candidates:read", "candidates:write", "institutions:read"],
  "profile": {
    "name": "ç®¡ç†å‘˜",
    "phone": "13800138000",
    "avatar": "https://example.com/avatar.jpg"
  },
  "last_login": "2025-08-04T10:00:00Z",
  "created_at": "2025-01-01T00:00:00Z"
}
```

**åº”ç”¨åœºæ™¯**: ç”¨æˆ·ä¿¡æ¯å±•ç¤ºã€æƒé™éªŒè¯

---

### 3. ğŸ¢ æœºæ„ç®¡ç†æ¥å£

#### 3.1 è·å–æœºæ„åˆ—è¡¨
```http
GET /institutions
```

**åŠŸèƒ½æè¿°**: åˆ†é¡µè·å–æœºæ„åˆ—è¡¨ï¼Œæ”¯æŒæœç´¢å’Œç­›é€‰

**æŸ¥è¯¢å‚æ•°**:
- `page` (int): é¡µç ï¼Œé»˜è®¤1
- `size` (int): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§100
- `status` (string): çŠ¶æ€ç­›é€‰ (active/inactive)
- `search` (string): æœç´¢å…³é”®è¯ï¼ˆæœºæ„åç§°ã€è”ç³»äººï¼‰
- `sort` (string): æ’åºå­—æ®µ (name/created_at)
- `order` (string): æ’åºæ–¹å‘ (asc/desc)

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /institutions?page=1&size=20&status=active&search=èˆªç©º&sort=created_at&order=desc
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æœºæ„åˆ—è¡¨è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒ",
      "code": "BJHK001",
      "contact_person": "å¼ ç»ç†",
      "phone": "010-12345678",
      "email": "contact@bjhk.com",
      "address": "åŒ—äº¬å¸‚æœé˜³åŒºèˆªç©ºè·¯123å·",
      "status": "active",
      "license_number": "L123456789",
      "business_scope": "æ— äººæœºé©¾é©¶å‘˜åŸ¹è®­",
      "stats": {
        "total_candidates": 156,
        "active_schedules": 8,
        "completed_exams": 89
      },
      "created_at": "2025-01-01T10:00:00Z",
      "updated_at": "2025-08-01T15:30:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 10,
    "total": 25,
    "pages": 3
  },
  "filters": {
    "status": "active",
    "search": "èˆªç©º"
  }
}
```

**åº”ç”¨åœºæ™¯**: æœºæ„ç®¡ç†åˆ—è¡¨é¡µé¢ã€æœºæ„é€‰æ‹©ä¸‹æ‹‰æ¡†

---

#### 3.2 è·å–æœºæ„è¯¦æƒ…
```http
GET /institutions/{institution_id}
```

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šæœºæ„çš„è¯¦ç»†ä¿¡æ¯

**è·¯å¾„å‚æ•°**:
- `institution_id` (int): æœºæ„ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æœºæ„è¯¦æƒ…è·å–æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒ",
    "code": "BJHK001",
    "contact_person": "å¼ ç»ç†",
    "phone": "010-12345678",
    "email": "contact@bjhk.com",
    "address": "åŒ—äº¬å¸‚æœé˜³åŒºèˆªç©ºè·¯123å·",
    "description": "ä¸“ä¸šçš„æ— äººæœºé©¾é©¶å‘˜åŸ¹è®­æœºæ„",
    "status": "active",
    "license_number": "L123456789",
    "business_scope": "æ— äººæœºé©¾é©¶å‘˜åŸ¹è®­ã€èˆªç©ºå™¨ç»´ä¿®åŸ¹è®­",
    "stats": {
      "total_candidates": 156,
      "active_schedules": 8,
      "completed_exams": 89,
      "pass_rate": 0.85,
      "monthly_growth": 0.12
    },
    "recent_activities": [
      {
        "date": "2025-08-01",
        "activity": "æ–°å¢è€ƒç”Ÿ20äºº",
        "type": "candidate_registration"
      }
    ],
    "created_at": "2025-01-01T10:00:00Z",
    "updated_at": "2025-08-01T15:30:00Z"
  }
}
```

**é”™è¯¯å“åº”** (404):
```json
{
  "detail": "æœºæ„ä¸å­˜åœ¨",
  "error_code": "INSTITUTION_NOT_FOUND",
  "institution_id": 999
}
```

**åº”ç”¨åœºæ™¯**: æœºæ„è¯¦æƒ…é¡µé¢ã€æœºæ„ä¿¡æ¯ç¼–è¾‘

---

#### 3.3 åˆ›å»ºæœºæ„
```http
POST /institutions
```

**åŠŸèƒ½æè¿°**: åˆ›å»ºæ–°çš„åŸ¹è®­æœºæ„

**è¯·æ±‚å‚æ•°**:
```json
{
  "name": "ä¸Šæµ·èˆªç©ºå­¦é™¢",
  "code": "SHHK002",
  "contact_person": "æä¸»ä»»",
  "phone": "021-87654321",
  "email": "contact@shhk.edu.cn",
  "address": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºèˆªç©ºè·¯456å·",
  "description": "ä¸“ä¸šèˆªç©ºåŸ¹è®­æœºæ„",
  "license_number": "L987654321",
  "business_scope": "æ— äººæœºé©¾é©¶å‘˜åŸ¹è®­ã€é£è¡Œå‘˜åŸ¹è®­"
}
```

**å‚æ•°è¯´æ˜**:
- `name` (string, å¿…å¡«): æœºæ„åç§°ï¼Œ2-100å­—ç¬¦
- `code` (string, å¯é€‰): æœºæ„ä»£ç ï¼Œå”¯ä¸€æ ‡è¯†
- `contact_person` (string, å¿…å¡«): è”ç³»äººå§“å
- `phone` (string, å¿…å¡«): è”ç³»ç”µè¯
- `email` (string, å¯é€‰): è”ç³»é‚®ç®±
- `address` (string, å¯é€‰): æœºæ„åœ°å€
- `license_number` (string, å¯é€‰): è®¸å¯è¯å·ç 

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æœºæ„åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 2,
    "name": "ä¸Šæµ·èˆªç©ºå­¦é™¢",
    "code": "SHHK002",
    "contact_person": "æä¸»ä»»",
    "phone": "021-87654321",
    "email": "contact@shhk.edu.cn",
    "status": "active",
    "created_at": "2025-08-04T10:00:00Z"
  }
}
```

**åº”ç”¨åœºæ™¯**: æ–°æœºæ„æ³¨å†Œã€ç³»ç»Ÿç®¡ç†å‘˜æ·»åŠ æœºæ„

---

#### 3.4 æ›´æ–°æœºæ„ä¿¡æ¯
```http
PUT /institutions/{institution_id}
```

**åŠŸèƒ½æè¿°**: æ›´æ–°æŒ‡å®šæœºæ„çš„ä¿¡æ¯

**è·¯å¾„å‚æ•°**:
- `institution_id` (int): æœºæ„ID

**è¯·æ±‚å‚æ•°**:
```json
{
  "name": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒï¼ˆæ›´æ–°ï¼‰",
  "contact_person": "ç‹ç»ç†",
  "phone": "010-87654321",
  "email": "new_contact@bjhk.com",
  "address": "åŒ—äº¬å¸‚æœé˜³åŒºæ–°èˆªç©ºè·¯789å·",
  "description": "ä¸“ä¸šçš„æ— äººæœºåŸ¹è®­æœºæ„ï¼Œæä¾›å…¨æ–¹ä½åŸ¹è®­æœåŠ¡"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æœºæ„ä¿¡æ¯æ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒï¼ˆæ›´æ–°ï¼‰",
    "contact_person": "ç‹ç»ç†",
    "phone": "010-87654321",
    "updated_at": "2025-08-04T10:00:00Z"
  }
}
```

**åº”ç”¨åœºæ™¯**: æœºæ„ä¿¡æ¯ç»´æŠ¤ã€è”ç³»æ–¹å¼æ›´æ–°

---

#### 3.5 åˆ é™¤æœºæ„
```http
DELETE /institutions/{institution_id}
```

**åŠŸèƒ½æè¿°**: åˆ é™¤æŒ‡å®šæœºæ„ï¼ˆè½¯åˆ é™¤ï¼‰

**è·¯å¾„å‚æ•°**:
- `institution_id` (int): æœºæ„ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æœºæ„åˆ é™¤æˆåŠŸ",
  "institution_id": 1,
  "deleted_at": "2025-08-04T10:00:00Z"
}
```

**æ³¨æ„äº‹é¡¹**:
- åªæœ‰å½“æœºæ„ä¸‹æ²¡æœ‰æ´»è·ƒçš„è€ƒç”Ÿå’Œæ’æœŸæ—¶æ‰èƒ½åˆ é™¤
- æ‰§è¡Œè½¯åˆ é™¤ï¼Œæ•°æ®ä»ä¿ç•™åœ¨æ•°æ®åº“ä¸­
- éœ€è¦ç®¡ç†å‘˜æƒé™

**åº”ç”¨åœºæ™¯**: æœºæ„æ³¨é”€ã€æ•°æ®æ¸…ç†

---

### 4. ğŸ‘¨â€ğŸ“ è€ƒç”Ÿç®¡ç†æ¥å£

#### 4.1 è·å–è€ƒç”Ÿåˆ—è¡¨
```http
GET /candidates
```

**åŠŸèƒ½æè¿°**: åˆ†é¡µè·å–è€ƒç”Ÿåˆ—è¡¨ï¼Œæ”¯æŒå¤šæ¡ä»¶ç­›é€‰å’Œæœç´¢

**æŸ¥è¯¢å‚æ•°**:
- `page` (int): é¡µç ï¼Œé»˜è®¤1
- `size` (int): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§100
- `status` (string): çŠ¶æ€ç­›é€‰ (å¾…æ’æœŸ/å·²å®¡æ ¸/å·²è€ƒè¯•/å·²é€šè¿‡/æœªé€šè¿‡)
- `exam_type` (string): è€ƒè¯•ç±»å‹ç­›é€‰
- `gender` (string): æ€§åˆ«ç­›é€‰ (ç”·/å¥³)
- `institution_id` (int): æœºæ„IDç­›é€‰
- `exam_product_id` (int): è€ƒè¯•äº§å“IDç­›é€‰
- `search` (string): æœç´¢å…³é”®è¯ï¼ˆå§“åã€èº«ä»½è¯ã€æ‰‹æœºå·ï¼‰
- `start_date` (string): æ³¨å†Œå¼€å§‹æ—¥æœŸ
- `end_date` (string): æ³¨å†Œç»“æŸæ—¥æœŸ
- `sort` (string): æ’åºå­—æ®µ
- `order` (string): æ’åºæ–¹å‘

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /candidates?page=1&size=20&status=å¾…æ’æœŸ&institution_id=1&search=å¼ &sort=created_at&order=desc
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒç”Ÿåˆ—è¡¨è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "å¼ ä¸‰",
      "id_number": "110101199001011234",
      "phone": "13800138001",
      "email": "zhangsan@example.com",
      "gender": "ç”·",
      "birth_date": "1990-01-01",
      "address": "åŒ—äº¬å¸‚æœé˜³åŒº",
      "status": "å¾…æ’æœŸ",
      "exam_product": {
        "id": 1,
        "name": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
        "category": "ç†è®º+å®æ“"
      },
      "institution": {
        "id": 1,
        "name": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒ"
      },
      "emergency_contact": "æå››",
      "emergency_phone": "13900139000",
      "registration_date": "2025-08-01",
      "notes": "å¤‡æ³¨ä¿¡æ¯",
      "created_at": "2025-08-01T10:00:00Z",
      "updated_at": "2025-08-01T10:00:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "total": 156,
    "pages": 8
  },
  "statistics": {
    "total_candidates": 156,
    "pending_schedule": 23,
    "scheduled": 45,
    "completed": 88
  }
}
```

**åº”ç”¨åœºæ™¯**: è€ƒç”Ÿç®¡ç†é¡µé¢ã€è€ƒç”Ÿç­›é€‰æŸ¥è¯¢

---

#### 4.2 è·å–è€ƒç”Ÿè¯¦æƒ…
```http
GET /candidates/{candidate_id}
```

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šè€ƒç”Ÿçš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬è€ƒè¯•å†å²ã€æ’æœŸä¿¡æ¯ç­‰

**è·¯å¾„å‚æ•°**:
- `candidate_id` (int): è€ƒç”ŸID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒç”Ÿè¯¦æƒ…è·å–æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "å¼ ä¸‰",
    "id_number": "110101199001011234",
    "phone": "13800138001",
    "email": "zhangsan@example.com",
    "gender": "ç”·",
    "birth_date": "1990-01-01",
    "address": "åŒ—äº¬å¸‚æœé˜³åŒºæŸæŸè¡—é“123å·",
    "status": "å·²æ’æœŸ",
    "exam_product": {
      "id": 1,
      "name": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
      "category": "ç†è®º+å®æ“",
      "duration": 120
    },
    "institution": {
      "id": 1,
      "name": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒ",
      "contact_person": "å¼ ç»ç†"
    },
    "emergency_contact": "æå››",
    "emergency_phone": "13900139000",
    "schedules": [
      {
        "id": 1,
        "exam_date": "2025-08-10",
        "start_time": "09:00:00",
        "end_time": "11:00:00",
        "venue": "ç¬¬ä¸€è€ƒåœº",
        "status": "å·²æ’æœŸ",
        "checkin_status": "æœªç­¾åˆ°"
      }
    ],
    "exam_history": [
      {
        "date": "2025-07-15",
        "exam_type": "ç†è®ºè€ƒè¯•",
        "score": 85,
        "result": "é€šè¿‡"
      }
    ],
    "documents": [
      {
        "type": "èº«ä»½è¯",
        "status": "å·²éªŒè¯"
      },
      {
        "type": "åŸ¹è®­è¯æ˜",
        "status": "å·²æäº¤"
      }
    ],
    "notes": "è€ƒç”Ÿè¡¨ç°è‰¯å¥½ï¼Œå‡†å¤‡å……åˆ†",
    "created_at": "2025-08-01T10:00:00Z",
    "updated_at": "2025-08-01T15:30:00Z"
  }
}
```

**åº”ç”¨åœºæ™¯**: è€ƒç”Ÿè¯¦æƒ…é¡µé¢ã€è€ƒç”Ÿæ¡£æ¡ˆæŸ¥çœ‹

---

#### 4.3 åˆ›å»ºè€ƒç”Ÿ
```http
POST /candidates
```

**åŠŸèƒ½æè¿°**: åˆ›å»ºæ–°çš„è€ƒç”Ÿè®°å½•

**è¯·æ±‚å‚æ•°**:
```json
{
  "name": "æå››",
  "id_number": "110101199102011235",
  "phone": "13800138002",
  "email": "lisi@example.com",
  "gender": "å¥³",
  "birth_date": "1991-02-01",
  "address": "åŒ—äº¬å¸‚æµ·æ·€åŒº",
  "emergency_contact": "ç‹äº”",
  "emergency_phone": "13900139001",
  "exam_product_id": 1,
  "institution_id": 1,
  "notes": "æ–°å­¦å‘˜ï¼Œé¦–æ¬¡æŠ¥è€ƒ"
}
```

**å‚æ•°è¯´æ˜**:
- `name` (string, å¿…å¡«): è€ƒç”Ÿå§“åï¼Œ2-50å­—ç¬¦
- `id_number` (string, å¿…å¡«): èº«ä»½è¯å·ï¼Œ18ä½
- `phone` (string, å¿…å¡«): æ‰‹æœºå·ï¼Œ11ä½
- `email` (string, å¯é€‰): é‚®ç®±åœ°å€
- `gender` (string, å¿…å¡«): æ€§åˆ«ï¼Œç”·/å¥³
- `birth_date` (string, å¯é€‰): å‡ºç”Ÿæ—¥æœŸï¼ŒYYYY-MM-DDæ ¼å¼
- `exam_product_id` (int, å¿…å¡«): è€ƒè¯•äº§å“ID
- `institution_id` (int, å¿…å¡«): æ‰€å±æœºæ„ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒç”Ÿåˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 2,
    "name": "æå››",
    "id_number": "110101199102011235",
    "phone": "13800138002",
    "status": "å¾…æ’æœŸ",
    "exam_product_name": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
    "institution_name": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒ",
    "created_at": "2025-08-04T10:00:00Z"
  }
}
```

**é”™è¯¯å“åº”** (400):
```json
{
  "detail": "èº«ä»½è¯å·å·²å­˜åœ¨",
  "error_code": "DUPLICATE_ID_NUMBER",
  "field": "id_number",
  "value": "110101199102011235"
}
```

**åº”ç”¨åœºæ™¯**: è€ƒç”Ÿæ³¨å†Œã€æ‰¹é‡å¯¼å…¥è€ƒç”Ÿ

---

#### 4.4 æ›´æ–°è€ƒç”Ÿä¿¡æ¯
```http
PUT /candidates/{candidate_id}
```

**åŠŸèƒ½æè¿°**: æ›´æ–°æŒ‡å®šè€ƒç”Ÿçš„ä¿¡æ¯

**è·¯å¾„å‚æ•°**:
- `candidate_id` (int): è€ƒç”ŸID

**è¯·æ±‚å‚æ•°**:
```json
{
  "name": "å¼ ä¸‰ï¼ˆæ›´æ–°ï¼‰",
  "phone": "13800138888",
  "email": "zhangsan_new@example.com",
  "address": "åŒ—äº¬å¸‚æœé˜³åŒºæ–°åœ°å€789å·",
  "emergency_contact": "æå››ï¼ˆæ›´æ–°ï¼‰",
  "emergency_phone": "13900139999",
  "notes": "æ›´æ–°åçš„å¤‡æ³¨ä¿¡æ¯"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒç”Ÿä¿¡æ¯æ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "å¼ ä¸‰ï¼ˆæ›´æ–°ï¼‰",
    "phone": "13800138888",
    "updated_at": "2025-08-04T10:00:00Z"
  }
}
```

**åº”ç”¨åœºæ™¯**: è€ƒç”Ÿä¿¡æ¯ç»´æŠ¤ã€è”ç³»æ–¹å¼æ›´æ–°

---

#### 4.5 åˆ é™¤è€ƒç”Ÿ
```http
DELETE /candidates/{candidate_id}
```

**åŠŸèƒ½æè¿°**: åˆ é™¤æŒ‡å®šè€ƒç”Ÿè®°å½•

**è·¯å¾„å‚æ•°**:
- `candidate_id` (int): è€ƒç”ŸID

**å“åº”ç¤ºä¾‹** (204):
```json
{
  "message": "è€ƒç”Ÿåˆ é™¤æˆåŠŸ",
  "candidate_id": 1,
  "deleted_at": "2025-08-04T10:00:00Z"
}
```

**æ³¨æ„äº‹é¡¹**:
- åªæœ‰åœ¨è€ƒç”Ÿæ²¡æœ‰å·²æ’æœŸçš„è€ƒè¯•æ—¶æ‰èƒ½åˆ é™¤
- æ‰§è¡Œè½¯åˆ é™¤ï¼Œä¿ç•™å†å²è®°å½•

**åº”ç”¨åœºæ™¯**: è€ƒç”Ÿä¿¡æ¯æ¸…ç†ã€é”™è¯¯æ•°æ®åˆ é™¤

---

### 5. ğŸ“ è€ƒè¯•äº§å“ç®¡ç†æ¥å£

#### 5.1 è·å–è€ƒè¯•äº§å“åˆ—è¡¨
```http
GET /exam-products
```

**åŠŸèƒ½æè¿°**: è·å–æ‰€æœ‰å¯ç”¨çš„è€ƒè¯•äº§å“åˆ—è¡¨

**æŸ¥è¯¢å‚æ•°**:
- `page` (int): é¡µç ï¼Œé»˜è®¤1
- `size` (int): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100
- `category` (string): è€ƒè¯•ç±»åˆ«ç­›é€‰ (ç†è®º/å®æ“/ç†è®º+å®æ“)
- `status` (string): çŠ¶æ€ç­›é€‰ (active/inactive)
- `difficulty` (string): éš¾åº¦ç­›é€‰ (ç®€å•/ä¸­ç­‰/å›°éš¾)
- `search` (string): æœç´¢å…³é”®è¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒè¯•äº§å“åˆ—è¡¨è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
      "description": "æ°‘ç”¨æ— äººæœºé©¾é©¶å‘˜èµ„æ ¼è€ƒè¯•",
      "code": "UAV_PILOT_001",
      "category": "ç†è®º+å®æ“",
      "exam_type": "æŠ€èƒ½è®¤è¯",
      "exam_class": "èŒä¸šèµ„æ ¼",
      "exam_level": "åˆçº§",
      "duration_minutes": 120,
      "theory_pass_score": 70,
      "practical_pass_score": 70,
      "training_hours": 60,
      "price": 500.00,
      "training_price": 2800.00,
      "difficulty": "ä¸­ç­‰",
      "status": "active",
      "requirements": [
        "å¹´æ»¡18å‘¨å²",
        "å…·æœ‰åˆä¸­ä»¥ä¸Šæ–‡åŒ–ç¨‹åº¦",
        "æ— è‰²ç›²è‰²å¼±"
      ],
      "theory_content": "æ— äººæœºåŸºç¡€çŸ¥è¯†ã€æ³•è§„ã€æ°”è±¡å­¦ã€é£è¡ŒåŸç†",
      "practical_content": "æ¨¡æ‹Ÿé£è¡Œã€å®é™…æ“ä½œã€åº”æ€¥å¤„ç½®",
      "statistics": {
        "total_candidates": 256,
        "pass_rate": 0.78,
        "average_score": 82.5
      },
      "created_at": "2025-01-01T10:00:00Z",
      "updated_at": "2025-08-01T10:00:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "total": 5,
    "pages": 1
  }
}
```

**åº”ç”¨åœºæ™¯**: è€ƒè¯•äº§å“é€‰æ‹©ã€äº§å“ç®¡ç†é¡µé¢

---

#### 5.2 è·å–è€ƒè¯•äº§å“è¯¦æƒ…
```http
GET /exam-products/{product_id}
```

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šè€ƒè¯•äº§å“çš„è¯¦ç»†ä¿¡æ¯

**è·¯å¾„å‚æ•°**:
- `product_id` (int): è€ƒè¯•äº§å“ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒè¯•äº§å“è¯¦æƒ…è·å–æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
    "description": "æ°‘ç”¨æ— äººæœºé©¾é©¶å‘˜èµ„æ ¼è€ƒè¯•ï¼ŒåŒ…å«ç†è®ºå’Œå®æ“ä¸¤éƒ¨åˆ†",
    "code": "UAV_PILOT_001",
    "category": "ç†è®º+å®æ“",
    "exam_type": "æŠ€èƒ½è®¤è¯",
    "exam_class": "èŒä¸šèµ„æ ¼",
    "exam_level": "åˆçº§",
    "duration_minutes": 120,
    "theory_pass_score": 70,
    "practical_pass_score": 70,
    "training_hours": 60,
    "price": 500.00,
    "training_price": 2800.00,
    "difficulty": "ä¸­ç­‰",
    "status": "active",
    "syllabus": {
      "theory": [
        "æ— äººæœºåŸºç¡€çŸ¥è¯†",
        "ç›¸å…³æ³•å¾‹æ³•è§„",
        "æ°”è±¡å­¦åŸºç¡€",
        "é£è¡ŒåŸç†",
        "å®‰å…¨çŸ¥è¯†"
      ],
      "practical": [
        "æ¨¡æ‹Ÿé£è¡Œè®­ç»ƒ",
        "å®é™…æ“ä½œè€ƒæ ¸",
        "åº”æ€¥å¤„ç½®æ¼”ç»ƒ",
        "è®¾å¤‡æ£€æŸ¥ç»´æŠ¤"
      ]
    },
    "requirements": [
      "å¹´æ»¡18å‘¨å²",
      "å…·æœ‰åˆä¸­ä»¥ä¸Šæ–‡åŒ–ç¨‹åº¦",
      "æ— è‰²ç›²è‰²å¼±",
      "èº«ä½“å¥åº·"
    ],
    "exam_schedule": {
      "theory_time": 90,
      "practical_time": 30,
      "break_time": 15
    },
    "statistics": {
      "total_candidates": 256,
      "pass_rate": 0.78,
      "average_theory_score": 85.2,
      "average_practical_score": 79.8,
      "monthly_enrollment": 45
    },
    "created_at": "2025-01-01T10:00:00Z",
    "updated_at": "2025-08-01T10:00:00Z"
  }
}
```

**åº”ç”¨åœºæ™¯**: è€ƒè¯•äº§å“è¯¦æƒ…é¡µé¢ã€è€ƒç”Ÿé€‰æ‹©è€ƒè¯•ç±»å‹

---

### 6. ğŸ« åœºåœ°ç®¡ç†æ¥å£

#### 6.1 è·å–åœºåœ°åˆ—è¡¨
```http
GET /venues
```

**åŠŸèƒ½æè¿°**: è·å–æ‰€æœ‰è€ƒè¯•åœºåœ°åˆ—è¡¨

**æŸ¥è¯¢å‚æ•°**:
- `page` (int): é¡µç ï¼Œé»˜è®¤1
- `size` (int): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100
- `type` (string): åœºåœ°ç±»å‹ç­›é€‰ (ç†è®ºè€ƒåœº/å®æ“è€ƒåœº/ç»¼åˆè€ƒåœº)
- `status` (string): çŠ¶æ€ç­›é€‰ (active/inactive/maintenance)
- `search` (string): æœç´¢å…³é”®è¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "åœºåœ°åˆ—è¡¨è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
      "type": "ç†è®ºè€ƒåœº",
      "location": "æ•™å­¦æ¥¼Aåº§201",
      "capacity": 50,
      "status": "active",
      "equipment": [
        "æŠ•å½±ä»ª",
        "éŸ³å“è®¾å¤‡",
        "ç©ºè°ƒ",
        "ç›‘æ§è®¾å¤‡"
      ],
      "current_usage": {
        "is_occupied": false,
        "current_exam": null,
        "next_exam": {
          "exam_name": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
          "start_time": "2025-08-05T09:00:00Z",
          "candidate_count": 25
        }
      },
      "maintenance_record": {
        "last_maintenance": "2025-07-15",
        "next_maintenance": "2025-09-15",
        "status": "è‰¯å¥½"
      },
      "created_at": "2025-01-01T10:00:00Z",
      "updated_at": "2025-08-01T10:00:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "total": 8,
    "pages": 1
  }
}
```

**åº”ç”¨åœºæ™¯**: åœºåœ°ç®¡ç†ã€è€ƒè¯•æ’æœŸå®‰æ’

---

#### 6.2 è·å–åœºåœ°è¯¦æƒ…
```http
GET /venues/{venue_id}
```

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šåœºåœ°çš„è¯¦ç»†ä¿¡æ¯

**è·¯å¾„å‚æ•°**:
- `venue_id` (int): åœºåœ°ID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "åœºåœ°è¯¦æƒ…è·å–æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
    "type": "ç†è®ºè€ƒåœº",
    "location": "æ•™å­¦æ¥¼Aåº§201",
    "capacity": 50,
    "area": 120.5,
    "status": "active",
    "description": "è®¾å¤‡é½å…¨çš„ç†è®ºè€ƒè¯•åœºåœ°ï¼Œé€‚åˆå„ç±»ç¬”è¯•è€ƒè¯•",
    "equipment": [
      {
        "name": "æŠ•å½±ä»ª",
        "model": "Epson EB-X41",
        "status": "æ­£å¸¸"
      },
      {
        "name": "éŸ³å“è®¾å¤‡",
        "model": "BOSE SoundTouch",
        "status": "æ­£å¸¸"
      }
    ],
    "layout": {
      "rows": 10,
      "seats_per_row": 5,
      "total_seats": 50
    },
    "schedule_today": [
      {
        "time": "09:00-11:00",
        "exam": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
        "candidates": 25,
        "status": "scheduled"
      },
      {
        "time": "14:00-16:00",
        "exam": "è®¡ç®—æœºç­‰çº§è€ƒè¯•",
        "candidates": 30,
        "status": "scheduled"
      }
    ],
    "utilization": {
      "this_week": 0.75,
      "this_month": 0.68,
      "average_candidates_per_session": 28
    },
    "maintenance_record": [
      {
        "date": "2025-07-15",
        "type": "å®šæœŸä¿å…»",
        "description": "è®¾å¤‡æ£€æŸ¥ï¼Œç¯å¢ƒæ¸…æ´",
        "cost": 500.00
      }
    ],
    "created_at": "2025-01-01T10:00:00Z",
    "updated_at": "2025-08-01T10:00:00Z"
  }
}
```

**åº”ç”¨åœºæ™¯**: åœºåœ°è¯¦æƒ…é¡µé¢ã€è®¾å¤‡ç®¡ç†ã€ç»´æŠ¤è®°å½•

---

### 7. ğŸ“… æ’æœŸç®¡ç†æ¥å£

#### 7.1 è·å–æ’æœŸåˆ—è¡¨
```http
GET /schedules
```

**åŠŸèƒ½æè¿°**: è·å–è€ƒè¯•æ’æœŸåˆ—è¡¨ï¼Œæ”¯æŒå¤šæ¡ä»¶ç­›é€‰

**æŸ¥è¯¢å‚æ•°**:
- `page` (int): é¡µç ï¼Œé»˜è®¤1
- `size` (int): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§100
- `candidate_id` (int): è€ƒç”ŸIDç­›é€‰
- `venue_id` (int): åœºåœ°IDç­›é€‰
- `exam_product_id` (int): è€ƒè¯•äº§å“IDç­›é€‰
- `status` (string): çŠ¶æ€ç­›é€‰ (scheduled/completed/cancelled)
- `exam_date` (string): è€ƒè¯•æ—¥æœŸç­›é€‰
- `start_date` (string): å¼€å§‹æ—¥æœŸèŒƒå›´
- `end_date` (string): ç»“æŸæ—¥æœŸèŒƒå›´

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ’æœŸåˆ—è¡¨è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "candidate": {
        "id": 1,
        "name": "å¼ ä¸‰",
        "phone": "13800138001"
      },
      "exam_product": {
        "id": 1,
        "name": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
        "category": "ç†è®º+å®æ“"
      },
      "venue": {
        "id": 1,
        "name": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
        "type": "ç†è®ºè€ƒåœº"
      },
      "exam_date": "2025-08-10",
      "start_time": "09:00:00",
      "end_time": "11:00:00",
      "schedule_type": "theory",
      "status": "scheduled",
      "checkin_status": "æœªç­¾åˆ°",
      "seat_number": "A01",
      "notes": "ä¸Šåˆç†è®ºè€ƒè¯•",
      "qr_code": "schedule_1_20250810",
      "created_at": "2025-08-01T10:00:00Z",
      "updated_at": "2025-08-01T10:00:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 10,
    "total": 156,
    "pages": 16
  },
  "statistics": {
    "total_schedules": 156,
    "scheduled": 89,
    "completed": 45,
    "cancelled": 12,
    "checked_in": 67
  }
}
```

**åº”ç”¨åœºæ™¯**: æ’æœŸç®¡ç†é¡µé¢ã€è€ƒè¯•å®‰æ’æŸ¥è¯¢

---

#### 7.2 æ‰¹é‡åˆ›å»ºæ’æœŸ
```http
POST /schedules/batch-create
```

**åŠŸèƒ½æè¿°**: æ‰¹é‡åˆ›å»ºè€ƒè¯•æ’æœŸ

**è¯·æ±‚å‚æ•°**:
```json
{
  "exam_date": "2025-08-15",
  "start_time": "09:00:00",
  "end_time": "11:00:00",
  "venue_id": 1,
  "exam_product_id": 1,
  "schedule_type": "theory",
  "candidate_ids": [1, 2, 3, 4, 5],
  "notes": "ç¬¬ä¸€æ‰¹ç†è®ºè€ƒè¯•",
  "auto_assign_seats": true
}
```

**å‚æ•°è¯´æ˜**:
- `exam_date` (string, å¿…å¡«): è€ƒè¯•æ—¥æœŸï¼ŒYYYY-MM-DDæ ¼å¼
- `start_time` (string, å¿…å¡«): å¼€å§‹æ—¶é—´ï¼ŒHH:MM:SSæ ¼å¼
- `end_time` (string, å¿…å¡«): ç»“æŸæ—¶é—´ï¼ŒHH:MM:SSæ ¼å¼
- `venue_id` (int, å¿…å¡«): åœºåœ°ID
- `exam_product_id` (int, å¿…å¡«): è€ƒè¯•äº§å“ID
- `candidate_ids` (array, å¿…å¡«): è€ƒç”ŸIDåˆ—è¡¨
- `auto_assign_seats` (bool): æ˜¯å¦è‡ªåŠ¨åˆ†é…åº§ä½

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ‰¹é‡æ’æœŸåˆ›å»ºæˆåŠŸ",
  "result": {
    "total_requested": 5,
    "success_count": 5,
    "failed_count": 0,
    "schedules": [
      {
        "id": 10,
        "candidate_id": 1,
        "candidate_name": "å¼ ä¸‰",
        "seat_number": "A01",
        "qr_code": "schedule_10_20250815"
      },
      {
        "id": 11,
        "candidate_id": 2,
        "candidate_name": "æå››",
        "seat_number": "A02",
        "qr_code": "schedule_11_20250815"
      }
    ],
    "failed_items": [],
    "venue_info": {
      "name": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
      "remaining_capacity": 45
    }
  }
}
```

**åº”ç”¨åœºæ™¯**: æ‰¹é‡æ’æœŸå®‰æ’ã€è€ƒè¯•ç»„ç»‡

---

#### 7.3 æ›´æ–°æ’æœŸ
```http
PUT /schedules/{schedule_id}
```

**åŠŸèƒ½æè¿°**: æ›´æ–°æŒ‡å®šæ’æœŸçš„ä¿¡æ¯

**è·¯å¾„å‚æ•°**:
- `schedule_id` (int): æ’æœŸID

**è¯·æ±‚å‚æ•°**:
```json
{
  "exam_date": "2025-08-12",
  "start_time": "14:00:00",
  "end_time": "16:00:00",
  "venue_id": 2,
  "seat_number": "B05",
  "notes": "è°ƒæ•´åˆ°ä¸‹åˆåœºæ¬¡"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ’æœŸæ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "exam_date": "2025-08-12",
    "start_time": "14:00:00",
    "end_time": "16:00:00",
    "venue_name": "ç¬¬äºŒç†è®ºè€ƒåœº",
    "seat_number": "B05",
    "updated_at": "2025-08-04T10:00:00Z"
  }
}
```

**åº”ç”¨åœºæ™¯**: æ’æœŸè°ƒæ•´ã€æ—¶é—´å˜æ›´ã€åœºåœ°æ›´æ¢

---

### 8. ğŸ“± äºŒç»´ç ç­¾åˆ°æ¥å£

#### 8.1 ç”Ÿæˆè€ƒè¯•äºŒç»´ç 
```http
GET /qrcode/generate-schedule-qr/{schedule_id}
```

**åŠŸèƒ½æè¿°**: ä¸ºæŒ‡å®šæ’æœŸç”Ÿæˆç­¾åˆ°äºŒç»´ç 

**è·¯å¾„å‚æ•°**:
- `schedule_id` (int): æ’æœŸID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒè¯•æ’æœŸäºŒç»´ç ç”ŸæˆæˆåŠŸ",
  "data": {
    "schedule_id": 1,
    "qr_content": "schedule_checkin_1_20250810_09001100",
    "qr_url": "https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=schedule_checkin_1_20250810_09001100",
    "qr_data": {
      "type": "schedule_checkin",
      "schedule_id": 1,
      "exam_date": "2025-08-10",
      "start_time": "09:00:00",
      "venue": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
      "timestamp": "2025-08-04T10:00:00Z",
      "valid_until": "2025-08-10T11:00:00Z"
    },
    "scan_instructions": "è€ƒç”Ÿè¯·åœ¨è€ƒè¯•å¼€å§‹å‰30åˆ†é’Ÿæ‰«ææ­¤äºŒç»´ç è¿›è¡Œç­¾åˆ°",
    "validity": {
      "valid_from": "2025-08-10T08:30:00Z",
      "valid_until": "2025-08-10T11:00:00Z",
      "timezone": "Asia/Shanghai"
    }
  }
}
```

**åº”ç”¨åœºæ™¯**: è€ƒè¯•ç­¾åˆ°å‡†å¤‡ã€äºŒç»´ç æ‰“å°ã€è€ƒåŠ¡ç®¡ç†

---

#### 8.2 æ‰«ç ç­¾åˆ°
```http
POST /qrcode/scan-checkin
```

**åŠŸèƒ½æè¿°**: é€šè¿‡æ‰«æäºŒç»´ç è¿›è¡Œè€ƒç”Ÿç­¾åˆ°

**è¯·æ±‚å‚æ•°**:
```json
{
  "qr_content": "schedule_checkin_1_20250810_09001100",
  "staff_id": 1,
  "checkin_location": "è€ƒåœºå…¥å£",
  "notes": "æ­£å¸¸ç­¾åˆ°"
}
```

**å‚æ•°è¯´æ˜**:
- `qr_content` (string, å¿…å¡«): æ‰«æçš„äºŒç»´ç å†…å®¹
- `staff_id` (int, å¯é€‰): è€ƒåŠ¡äººå‘˜ID
- `checkin_location` (string, å¯é€‰): ç­¾åˆ°åœ°ç‚¹
- `notes` (string, å¯é€‰): ç­¾åˆ°å¤‡æ³¨

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "ç­¾åˆ°æˆåŠŸ",
  "data": {
    "checkin_id": 1,
    "schedule": {
      "id": 1,
      "exam_date": "2025-08-10",
      "start_time": "09:00:00",
      "venue": "ç¬¬ä¸€ç†è®ºè€ƒåœº"
    },
    "candidate": {
      "id": 1,
      "name": "å¼ ä¸‰",
      "id_number": "110101199001011234",
      "seat_number": "A01"
    },
    "checkin_info": {
      "checkin_time": "2025-08-10T08:45:00Z",
      "status": "å·²ç­¾åˆ°",
      "early_minutes": 15,
      "staff_name": "ç‹è€å¸ˆ"
    },
    "next_steps": [
      "è¯·å‰å¾€åº§ä½A01å°±åº§",
      "è€ƒè¯•å°†åœ¨09:00å‡†æ—¶å¼€å§‹",
      "è¯·å‡†å¤‡å¥½èº«ä»½è¯å’Œå‡†è€ƒè¯"
    ]
  }
}
```

**é”™è¯¯å“åº”** (400):
```json
{
  "detail": "äºŒç»´ç å·²è¿‡æœŸæˆ–æ— æ•ˆ",
  "error_code": "INVALID_QR_CODE",
  "qr_content": "schedule_checkin_1_20250810_09001100",
  "valid_until": "2025-08-10T11:00:00Z"
}
```

**åº”ç”¨åœºæ™¯**: è€ƒç”Ÿç­¾åˆ°ã€è€ƒå‹¤ç®¡ç†ã€èº«ä»½éªŒè¯

---

#### 8.3 ç­¾åˆ°çŠ¶æ€æŸ¥è¯¢
```http
GET /qrcode/checkin-status/{schedule_id}
```

**åŠŸèƒ½æè¿°**: æŸ¥è¯¢æŒ‡å®šæ’æœŸçš„ç­¾åˆ°çŠ¶æ€

**è·¯å¾„å‚æ•°**:
- `schedule_id` (int): æ’æœŸID

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "ç­¾åˆ°çŠ¶æ€æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "schedule": {
      "id": 1,
      "exam_date": "2025-08-10",
      "start_time": "09:00:00",
      "venue": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
      "total_candidates": 25
    },
    "checkin_status": {
      "checked_in": 23,
      "not_checked_in": 2,
      "checkin_rate": 0.92,
      "last_checkin_time": "2025-08-10T08:55:00Z"
    },
    "checkin_details": [
      {
        "candidate_id": 1,
        "candidate_name": "å¼ ä¸‰",
        "seat_number": "A01",
        "checkin_time": "2025-08-10T08:45:00Z",
        "status": "å·²ç­¾åˆ°"
      },
      {
        "candidate_id": 2,
        "candidate_name": "æå››",
        "seat_number": "A02",
        "checkin_time": null,
        "status": "æœªç­¾åˆ°"
      }
    ],
    "statistics": {
      "earliest_checkin": "2025-08-10T08:30:00Z",
      "latest_checkin": "2025-08-10T08:55:00Z",
      "average_early_minutes": 12
    }
  }
}
```

**åº”ç”¨åœºæ™¯**: è€ƒåŠ¡ç®¡ç†ã€ç­¾åˆ°ç»Ÿè®¡ã€è€ƒè¯•ç»„ç»‡

---

### 9. ğŸ“Š æ‰¹é‡æ“ä½œæ¥å£

#### 9.1 ä¸‹è½½è€ƒç”Ÿå¯¼å…¥æ¨¡æ¿
```http
GET /batch/candidates/template
```

**åŠŸèƒ½æè¿°**: ä¸‹è½½Excelæ ¼å¼çš„è€ƒç”Ÿæ‰¹é‡å¯¼å…¥æ¨¡æ¿

**å“åº”**: Excelæ–‡ä»¶ä¸‹è½½

**æ¨¡æ¿åŒ…å«å­—æ®µ**:
- è€ƒç”Ÿå§“å (å¿…å¡«)
- èº«ä»½è¯å· (å¿…å¡«)
- è”ç³»ç”µè¯ (å¿…å¡«)
- é‚®ç®±åœ°å€ (å¯é€‰)
- æ€§åˆ« (å¿…å¡«: ç”·/å¥³)
- å‡ºç”Ÿæ—¥æœŸ (å¯é€‰: YYYY-MM-DD)
- åœ°å€ (å¯é€‰)
- ç´§æ€¥è”ç³»äºº (å¯é€‰)
- ç´§æ€¥è”ç³»ç”µè¯ (å¯é€‰)
- è€ƒè¯•äº§å“åç§° (å¿…å¡«)
- æœºæ„åç§° (å¿…å¡«)
- å¤‡æ³¨ (å¯é€‰)

**åº”ç”¨åœºæ™¯**: æ‰¹é‡æ•°æ®å‡†å¤‡ã€Excelæ¨¡æ¿ä¸‹è½½

---

#### 9.2 æ‰¹é‡å¯¼å…¥è€ƒç”Ÿ
```http
POST /batch/candidates/import
```

**åŠŸèƒ½æè¿°**: é€šè¿‡Excelæ–‡ä»¶æ‰¹é‡å¯¼å…¥è€ƒç”Ÿæ•°æ®

**è¯·æ±‚å‚æ•°**:
- `file` (file): Excelæ–‡ä»¶
- `institution_id` (int): é»˜è®¤æœºæ„IDï¼ˆå¯é€‰ï¼‰
- `exam_product_id` (int): é»˜è®¤è€ƒè¯•äº§å“IDï¼ˆå¯é€‰ï¼‰
- `skip_duplicates` (bool): æ˜¯å¦è·³è¿‡é‡å¤æ•°æ®

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ‰¹é‡å¯¼å…¥è€ƒç”Ÿå®Œæˆ",
  "result": {
    "total_rows": 50,
    "processed_rows": 48,
    "success_count": 45,
    "failed_count": 3,
    "skipped_count": 2,
    "success_items": [
      {
        "row": 2,
        "name": "å¼ ä¸‰",
        "id_number": "110101199001011234",
        "candidate_id": 101,
        "status": "åˆ›å»ºæˆåŠŸ"
      },
      {
        "row": 3,
        "name": "æå››",
        "id_number": "110101199102011235",
        "candidate_id": 102,
        "status": "åˆ›å»ºæˆåŠŸ"
      }
    ],
    "failed_items": [
      {
        "row": 10,
        "name": "ç‹äº”",
        "id_number": "invalid_id",
        "error": "èº«ä»½è¯å·æ ¼å¼é”™è¯¯",
        "error_code": "INVALID_ID_FORMAT"
      }
    ],
    "skipped_items": [
      {
        "row": 15,
        "name": "èµµå…­",
        "id_number": "110101199001011234",
        "reason": "èº«ä»½è¯å·é‡å¤",
        "existing_candidate_id": 50
      }
    ],
    "import_summary": {
      "import_time": "2025-08-04T10:00:00Z",
      "import_user": "admin",
      "file_name": "candidates_20250804.xlsx",
      "processing_time": "00:02:15"
    }
  }
}
```

**é”™è¯¯å“åº”** (400):
```json
{
  "detail": "æ–‡ä»¶æ ¼å¼é”™è¯¯æˆ–ä¸ºç©º",
  "error_code": "INVALID_FILE_FORMAT",
  "supported_formats": [".xlsx", ".xls"]
}
```

**åº”ç”¨åœºæ™¯**: æ‰¹é‡è€ƒç”Ÿæ³¨å†Œã€æ•°æ®è¿ç§»ã€Excelæ•°æ®å¯¼å…¥

---

#### 9.3 æ‰¹é‡æ’æœŸ
```http
POST /batch/schedules
```

**åŠŸèƒ½æè¿°**: æ‰¹é‡åˆ›å»ºè€ƒè¯•æ’æœŸ

**è¯·æ±‚å‚æ•°**:
```json
{
  "exam_date": "2025-08-15",
  "start_time": "09:00:00",
  "venue_id": 1,
  "exam_product_id": 1,
  "duration_minutes": 120,
  "candidate_ids": [1, 2, 3, 4, 5],
  "schedule_type": "theory",
  "auto_assign_seats": true,
  "break_time_minutes": 15,
  "notes": "ç¬¬ä¸€æ‰¹æ¬¡è€ƒè¯•"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æ‰¹é‡æ’æœŸåˆ›å»ºæˆåŠŸ",
  "result": {
    "total_candidates": 5,
    "success_count": 5,
    "failed_count": 0,
    "schedules": [
      {
        "schedule_id": 20,
        "candidate_id": 1,
        "candidate_name": "å¼ ä¸‰",
        "start_time": "09:00:00",
        "end_time": "11:00:00",
        "seat_number": "A01"
      }
    ],
    "venue_info": {
      "venue_name": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
      "total_capacity": 50,
      "used_capacity": 5,
      "remaining_capacity": 45
    },
    "time_slots": {
      "theory_session": {
        "start": "09:00:00",
        "end": "10:30:00"
      },
      "break": {
        "start": "10:30:00",
        "end": "10:45:00"
      },
      "practical_session": {
        "start": "10:45:00",
        "end": "11:00:00"
      }
    }
  }
}
```

**åº”ç”¨åœºæ™¯**: æ‰¹é‡è€ƒè¯•å®‰æ’ã€è€ƒæœŸç»„ç»‡ã€æ’æœŸç®¡ç†

---

### 10. ğŸ‘¨â€ğŸ’¼ ç”¨æˆ·æƒé™ç®¡ç†æ¥å£

#### 10.1 è·å–ç”¨æˆ·åˆ—è¡¨
```http
GET /users
```

**åŠŸèƒ½æè¿°**: è·å–ç³»ç»Ÿç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒè§’è‰²å’ŒçŠ¶æ€ç­›é€‰

**æŸ¥è¯¢å‚æ•°**:
- `page` (int): é¡µç ï¼Œé»˜è®¤1
- `size` (int): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§100
- `role` (string): è§’è‰²ç­›é€‰ (admin/examiner/student/teacher)
- `status` (string): çŠ¶æ€ç­›é€‰ (active/inactive)
- `institution_id` (int): æœºæ„IDç­›é€‰
- `search` (string): æœç´¢å…³é”®è¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "ç”¨æˆ·åˆ—è¡¨è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "username": "admin",
      "email": "admin@example.com",
      "role": "admin",
      "status": "active",
      "institution": {
        "id": null,
        "name": null
      },
      "profile": {
        "name": "ç³»ç»Ÿç®¡ç†å‘˜",
        "phone": "13800138000",
        "department": "æŠ€æœ¯éƒ¨"
      },
      "permissions": [
        "users:read",
        "users:write",
        "candidates:read",
        "candidates:write",
        "schedules:read",
        "schedules:write"
      ],
      "last_login": "2025-08-04T09:30:00Z",
      "created_at": "2025-01-01T00:00:00Z",
      "updated_at": "2025-08-04T09:30:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 10,
    "total": 25,
    "pages": 3
  },
  "role_statistics": {
    "admin": 2,
    "examiner": 8,
    "teacher": 12,
    "student": 3
  }
}
```

**åº”ç”¨åœºæ™¯**: ç”¨æˆ·ç®¡ç†ã€æƒé™åˆ†é…ã€ç³»ç»Ÿç®¡ç†

---

#### 10.2 åˆ›å»ºç”¨æˆ·
```http
POST /users
```

**åŠŸèƒ½æè¿°**: åˆ›å»ºæ–°çš„ç³»ç»Ÿç”¨æˆ·

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "teacher01",
  "email": "teacher01@example.com",
  "password": "SecurePass123!",
  "role": "teacher",
  "institution_id": 1,
  "profile": {
    "name": "å¼ è€å¸ˆ",
    "phone": "13900139000",
    "department": "æ•™å­¦éƒ¨"
  },
  "permissions": [
    "candidates:read",
    "schedules:read",
    "schedules:write"
  ]
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "ç”¨æˆ·åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 26,
    "username": "teacher01",
    "email": "teacher01@example.com",
    "role": "teacher",
    "status": "active",
    "institution_name": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒ",
    "created_at": "2025-08-04T10:00:00Z"
  }
}
```

**åº”ç”¨åœºæ™¯**: ç”¨æˆ·æ³¨å†Œã€ç³»ç»Ÿç®¡ç†ã€æƒé™åˆ†é…

---

### 11. ğŸ”„ å®æ—¶åŠŸèƒ½æ¥å£

#### 11.1 å®æ—¶çŠ¶æ€æŸ¥è¯¢
```http
GET /realtime/status
```

**åŠŸèƒ½æè¿°**: è·å–ç³»ç»Ÿå®æ—¶çŠ¶æ€ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "å®æ—¶çŠ¶æ€è·å–æˆåŠŸ",
  "data": {
    "timestamp": "2025-08-04T10:00:00Z",
    "system_status": {
      "status": "healthy",
      "active_users": 25,
      "active_sessions": 18,
      "database_connections": 12
    },
    "exam_status": {
      "ongoing_exams": 3,
      "today_schedules": 45,
      "checked_in_candidates": 32,
      "pending_checkins": 13
    },
    "venue_status": [
      {
        "venue_id": 1,
        "name": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
        "status": "occupied",
        "current_exam": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
        "candidate_count": 25,
        "remaining_time": 45
      }
    ],
    "notifications": [
      {
        "id": 1,
        "type": "warning",
        "message": "ç¬¬äºŒè€ƒåœºç©ºè°ƒæ•…éšœï¼Œè¯·åŠæ—¶ç»´ä¿®",
        "created_at": "2025-08-04T09:45:00Z"
      }
    ]
  }
}
```

**åº”ç”¨åœºæ™¯**: å®æ—¶ç›‘æ§ã€è¿è¥çŠ¶æ€ã€å†³ç­–æ”¯æŒ

---

#### 11.2 WebSocketè¿æ¥
```http
WS /realtime/ws/{user_id}
```

**åŠŸèƒ½æè¿°**: å»ºç«‹WebSocketè¿æ¥ï¼Œæ¥æ”¶å®æ—¶æ¨é€

**è¿æ¥å‚æ•°**:
- `user_id` (int): ç”¨æˆ·ID
- `token` (string): è®¤è¯ä»¤ç‰Œ (é€šè¿‡æŸ¥è¯¢å‚æ•°ä¼ é€’)

**æ¶ˆæ¯æ ¼å¼**:
```json
{
  "type": "checkin_update",
  "data": {
    "schedule_id": 1,
    "candidate_name": "å¼ ä¸‰",
    "checkin_time": "2025-08-04T08:45:00Z",
    "status": "checked_in"
  },
  "timestamp": "2025-08-04T08:45:00Z"
}
```

**æ¶ˆæ¯ç±»å‹**:
- `checkin_update`: ç­¾åˆ°çŠ¶æ€æ›´æ–°
- `schedule_change`: æ’æœŸå˜æ›´
- `system_notification`: ç³»ç»Ÿé€šçŸ¥
- `venue_status_change`: åœºåœ°çŠ¶æ€å˜æ›´

**åº”ç”¨åœºæ™¯**: å®æ—¶é€šä¿¡ã€çŠ¶æ€æ¨é€ã€æ¶ˆæ¯é€šçŸ¥

---

### 12. ğŸ“± å¾®ä¿¡å°ç¨‹åºæ¥å£

#### 12.1 è€ƒç”Ÿä¿¡æ¯æŸ¥è¯¢
```http
GET /wx-miniprogram/candidate-info
```

**åŠŸèƒ½æè¿°**: é€šè¿‡èº«ä»½è¯å·æŸ¥è¯¢è€ƒç”Ÿä¿¡æ¯

**æŸ¥è¯¢å‚æ•°**:
- `id_number` (string): èº«ä»½è¯å·

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒç”Ÿä¿¡æ¯æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "candidate": {
      "id": 1,
      "name": "å¼ ä¸‰",
      "phone": "13800138001",
      "status": "å·²æ’æœŸ",
      "exam_product": "æ— äººæœºé©¾é©¶å‘˜è€ƒè¯•",
      "institution": "åŒ—äº¬èˆªç©ºåŸ¹è®­ä¸­å¿ƒ",
      "registration_date": "2025-08-01"
    },
    "schedules": [
      {
        "id": 1,
        "exam_date": "2025-08-10",
        "start_time": "09:00:00",
        "venue": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
        "seat_number": "A01",
        "status": "å·²æ’æœŸ",
        "checkin_status": "æœªç­¾åˆ°"
      }
    ],
    "exam_tips": [
      "è¯·æå‰30åˆ†é’Ÿåˆ°è¾¾è€ƒåœº",
      "è¯·æºå¸¦èº«ä»½è¯åŸä»¶",
      "è€ƒè¯•æœŸé—´è¯·ä¿æŒå®‰é™"
    ]
  }
}
```

**åº”ç”¨åœºæ™¯**: å¾®ä¿¡å°ç¨‹åºã€è€ƒç”Ÿè‡ªåŠ©æŸ¥è¯¢ã€ç§»åŠ¨ç«¯æœåŠ¡

---

#### 12.2 è€ƒè¯•å®‰æ’æŸ¥è¯¢
```http
GET /wx-miniprogram/exam-schedule
```

**åŠŸèƒ½æè¿°**: æŸ¥è¯¢è€ƒç”Ÿçš„è€ƒè¯•å®‰æ’

**æŸ¥è¯¢å‚æ•°**:
- `id_number` (string): èº«ä»½è¯å·
- `phone` (string): æ‰‹æœºå·

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "è€ƒè¯•å®‰æ’æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "candidate_name": "å¼ ä¸‰",
    "upcoming_exams": [
      {
        "schedule_id": 1,
        "exam_date": "2025-08-10",
        "start_time": "09:00:00",
        "end_time": "11:00:00",
        "exam_type": "ç†è®ºè€ƒè¯•",
        "venue": "ç¬¬ä¸€ç†è®ºè€ƒåœº",
        "address": "æ•™å­¦æ¥¼Aåº§201",
        "seat_number": "A01",
        "checkin_start_time": "08:30:00",
        "preparation_items": [
          "èº«ä»½è¯åŸä»¶",
          "å‡†è€ƒè¯",
          "2Bé“…ç¬”",
          "æ©¡çš®æ“¦"
        ]
      }
    ],
    "exam_history": [
      {
        "exam_date": "2025-07-15",
        "exam_type": "æ¨¡æ‹Ÿè€ƒè¯•",
        "score": 85,
        "result": "é€šè¿‡"
      }
    ],
    "notifications": [
      "è¯·ç¡®è®¤è€ƒè¯•æ—¶é—´å’Œåœ°ç‚¹",
      "å¦‚æœ‰ç–‘é—®è¯·è”ç³»åŸ¹è®­æœºæ„"
    ]
  }
}
```

**åº”ç”¨åœºæ™¯**: å¾®ä¿¡å°ç¨‹åºã€è€ƒè¯•æé†’ã€ç§»åŠ¨æŸ¥è¯¢

---

## ğŸš¨ é”™è¯¯ç è¯´æ˜

### HTTPçŠ¶æ€ç 
| çŠ¶æ€ç  | è¯´æ˜ | åº”ç”¨åœºæ™¯ |
|--------|------|----------|
| 200 | è¯·æ±‚æˆåŠŸ | æ­£å¸¸å“åº” |
| 201 | åˆ›å»ºæˆåŠŸ | èµ„æºåˆ›å»º |
| 204 | åˆ é™¤æˆåŠŸï¼Œæ— è¿”å›å†…å®¹ | åˆ é™¤æ“ä½œ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | å‚æ•°éªŒè¯å¤±è´¥ |
| 401 | æœªæˆæƒï¼Œéœ€è¦ç™»å½• | è®¤è¯å¤±è´¥ |
| 403 | æƒé™ä¸è¶³ | æƒé™éªŒè¯å¤±è´¥ |
| 404 | èµ„æºä¸å­˜åœ¨ | èµ„æºæœªæ‰¾åˆ° |
| 409 | æ•°æ®å†²çª | é‡å¤æ•°æ® |
| 422 | è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥ | ä¸šåŠ¡é€»è¾‘éªŒè¯å¤±è´¥ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | ç³»ç»Ÿå¼‚å¸¸ |

### ä¸šåŠ¡é”™è¯¯ç 
| é”™è¯¯ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|
| INVALID_CREDENTIALS | ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ | æ£€æŸ¥ç™»å½•ä¿¡æ¯ |
| TOKEN_EXPIRED | è®¿é—®ä»¤ç‰Œå·²è¿‡æœŸ | é‡æ–°ç™»å½•è·å–ä»¤ç‰Œ |
| INSUFFICIENT_PERMISSIONS | æƒé™ä¸è¶³ | è”ç³»ç®¡ç†å‘˜åˆ†é…æƒé™ |
| DUPLICATE_ID_NUMBER | èº«ä»½è¯å·å·²å­˜åœ¨ | æ£€æŸ¥èº«ä»½è¯å·æ˜¯å¦é‡å¤ |
| INVALID_ID_FORMAT | èº«ä»½è¯å·æ ¼å¼é”™è¯¯ | æ£€æŸ¥èº«ä»½è¯å·æ ¼å¼ |
| CANDIDATE_NOT_FOUND | è€ƒç”Ÿä¸å­˜åœ¨ | æ£€æŸ¥è€ƒç”ŸID |
| INSTITUTION_NOT_FOUND | æœºæ„ä¸å­˜åœ¨ | æ£€æŸ¥æœºæ„ID |
| VENUE_OCCUPIED | åœºåœ°å·²è¢«å ç”¨ | é€‰æ‹©å…¶ä»–æ—¶é—´æˆ–åœºåœ° |
| SCHEDULE_CONFLICT | æ’æœŸæ—¶é—´å†²çª | è°ƒæ•´æ’æœŸæ—¶é—´ |
| INVALID_QR_CODE | äºŒç»´ç æ— æ•ˆæˆ–å·²è¿‡æœŸ | é‡æ–°ç”ŸæˆäºŒç»´ç  |
| FILE_FORMAT_ERROR | æ–‡ä»¶æ ¼å¼é”™è¯¯ | ä¸Šä¼ æ­£ç¡®æ ¼å¼çš„æ–‡ä»¶ |

---

## ğŸ› ï¸ éƒ¨ç½²æŒ‡å—

### ç¯å¢ƒè¦æ±‚
- **Python**: 3.8+
- **æ•°æ®åº“**: PostgreSQL 12+ / MySQL 8.0+
- **Redis**: 6.0+ (å¯é€‰ï¼Œç”¨äºç¼“å­˜)
- **Docker**: 20.0+ (å¯é€‰)

### æœ¬åœ°å¼€å‘ç¯å¢ƒ
```bash
# 1. å…‹éš†ä»£ç 
git clone https://github.com/codesoldier99/UAVexam_site_backend.git
cd exam_site_backend

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate  # Windows

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. é…ç½®ç¯å¢ƒå˜é‡
cp env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶é…ç½®æ•°æ®åº“ç­‰ä¿¡æ¯

# 5. æ•°æ®åº“è¿ç§»
alembic upgrade head

# 6. å¯åŠ¨æœåŠ¡
python start_server.py
```

### Dockeréƒ¨ç½²
```bash
# 1. æ„å»ºé•œåƒ
docker-compose build

# 2. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 3. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f api

# 4. åœæ­¢æœåŠ¡
docker-compose down
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# 1. ä½¿ç”¨ç”Ÿäº§é…ç½®
docker-compose -f docker-compose.prod.yml up -d

# 2. é…ç½®åå‘ä»£ç† (Nginx)
# å‚è€ƒ nginx/nginx.conf é…ç½®æ–‡ä»¶

# 3. SSLè¯ä¹¦é…ç½®
# ä½¿ç”¨ Let's Encrypt æˆ–å…¶ä»–è¯ä¹¦

# 4. ç›‘æ§å’Œæ—¥å¿—
# é…ç½®æ—¥å¿—æ”¶é›†å’Œç›‘æ§ç³»ç»Ÿ
```

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://user:password@localhost/exam_db
DB_HOST=localhost
DB_PORT=5432
DB_NAME=exam_db
DB_USER=exam_user
DB_PASSWORD=secure_password

# åº”ç”¨é…ç½®
SECRET_KEY=your-super-secret-key-here
DEBUG=False
CORS_ORIGINS=["http://localhost:3000", "https://yourdomain.com"]

# JWTé…ç½®
JWT_SECRET_KEY=jwt-secret-key
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# Redisé…ç½® (å¯é€‰)
REDIS_URL=redis://localhost:6379/0

# æ–‡ä»¶å­˜å‚¨é…ç½®
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=10485760  # 10MB

# é‚®ä»¶é…ç½® (å¯é€‰)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# å¾®ä¿¡å°ç¨‹åºé…ç½® (å¯é€‰)
WECHAT_APP_ID=your-wechat-app-id
WECHAT_APP_SECRET=your-wechat-app-secret
```

---

## ğŸ§ª æµ‹è¯•è¯´æ˜

### æµ‹è¯•æ–‡ä»¶è¯´æ˜
- `api_full_test.py`: å®Œæ•´APIæµ‹è¯•å¥—ä»¶
- `test_core_features.py`: æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
- `comprehensive_api_test.py`: ç»¼åˆAPIæµ‹è¯•
- `api_status_check.py`: APIçŠ¶æ€æ£€æŸ¥
- `quick_api_test.py`: å¿«é€ŸAPIæµ‹è¯•

### è¿è¡Œæµ‹è¯•
```bash
# å®Œæ•´æµ‹è¯•
python api_full_test.py

# æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
python test_core_features.py

# çŠ¶æ€æ£€æŸ¥
python api_status_check.py

# ä½¿ç”¨pytestè¿è¡Œæµ‹è¯•
pytest src/tests/ -v

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
pytest src/tests/ --html=report.html
```

### æµ‹è¯•è¦†ç›–ç‡
```bash
# å®‰è£…è¦†ç›–ç‡å·¥å…·
pip install pytest-cov

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
pytest src/tests/ --cov=src --cov-report=html

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
open htmlcov/index.html
```

### APIæµ‹è¯•ç¤ºä¾‹
```python
import requests
import json

# åŸºç¡€URL
BASE_URL = "http://localhost:8000"

# æµ‹è¯•ç™»å½•
def test_login():
    url = f"{BASE_URL}/login"
    data = {
        "username": "admin",
        "password": "password"
    }
    response = requests.post(url, json=data)
    assert response.status_code == 200
    return response.json()["access_token"]

# æµ‹è¯•è·å–è€ƒç”Ÿåˆ—è¡¨
def test_get_candidates():
    token = test_login()
    url = f"{BASE_URL}/candidates"
    headers = {"Authorization": f"Bearer {token}"}
    response = requests.get(url, headers=headers)
    assert response.status_code == 200
    print(f"è·å–åˆ° {len(response.json()['data'])} ä¸ªè€ƒç”Ÿ")

if __name__ == "__main__":
    test_get_candidates()
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æ•°æ®åº“ä¼˜åŒ–
1. **ç´¢å¼•ä¼˜åŒ–**
   ```sql
   -- è€ƒç”Ÿè¡¨ç´¢å¼•
   CREATE INDEX idx_candidates_id_number ON candidates(id_number);
   CREATE INDEX idx_candidates_phone ON candidates(phone);
   CREATE INDEX idx_candidates_institution ON candidates(institution_id);
   
   -- æ’æœŸè¡¨ç´¢å¼•
   CREATE INDEX idx_schedules_date ON schedules(exam_date);
   CREATE INDEX idx_schedules_venue ON schedules(venue_id);
   CREATE INDEX idx_schedules_candidate ON schedules(candidate_id);
   ```

2. **æŸ¥è¯¢ä¼˜åŒ–**
   - ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢é¿å…å¤§æ•°æ®é‡è¿”å›
   - é€‚å½“ä½¿ç”¨ç¼“å­˜å‡å°‘æ•°æ®åº“å‹åŠ›
   - ä¼˜åŒ–å¤æ‚æŸ¥è¯¢ï¼Œé¿å…N+1é—®é¢˜

### æ¥å£æ€§èƒ½
1. **å“åº”æ—¶é—´ä¼˜åŒ–**
   - æ¥å£å“åº”æ—¶é—´æ§åˆ¶åœ¨200msä»¥å†…
   - å¤æ‚æŸ¥è¯¢ä½¿ç”¨å¼‚æ­¥å¤„ç†
   - å¤§æ–‡ä»¶ä¸Šä¼ ä½¿ç”¨åˆ†ç‰‡ä¸Šä¼ 

2. **å¹¶å‘å¤„ç†**
   - ä½¿ç”¨è¿æ¥æ± ç®¡ç†æ•°æ®åº“è¿æ¥
   - é€‚å½“çš„çº¿ç¨‹æ± é…ç½®
   - å®ç°è¯·æ±‚é™æµå’Œç†”æ–­æœºåˆ¶

### ç¼“å­˜ç­–ç•¥
1. **Redisç¼“å­˜**
   ```python
   # ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
   cache_key = f"user:{user_id}"
   cache_time = 3600  # 1å°æ—¶
   
   # ç¼“å­˜è€ƒè¯•äº§å“åˆ—è¡¨
   cache_key = "exam_products:list"
   cache_time = 1800  # 30åˆ†é’Ÿ
   ```

2. **åº”ç”¨ç¼“å­˜**
   - é™æ€æ•°æ®ç¼“å­˜ï¼ˆè€ƒè¯•äº§å“ã€åœºåœ°ä¿¡æ¯ï¼‰
   - ç”¨æˆ·æƒé™ç¼“å­˜
   - é…ç½®ä¿¡æ¯ç¼“å­˜

---

## ğŸ” å®‰å…¨è¯´æ˜

### è®¤è¯å®‰å…¨
1. **JWT Tokenå®‰å…¨**
   - ä½¿ç”¨å¼ºå¯†é’¥ç”ŸæˆToken
   - è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´
   - å®ç°Tokenåˆ·æ–°æœºåˆ¶

2. **å¯†ç å®‰å…¨**
   - ä½¿ç”¨bcryptç­‰å¼ºåŠ å¯†ç®—æ³•
   - å®ç°å¯†ç å¤æ‚åº¦è¦æ±‚
   - ç™»å½•å¤±è´¥æ¬¡æ•°é™åˆ¶

### æ•°æ®å®‰å…¨
1. **æ•æ„Ÿæ•°æ®ä¿æŠ¤**
   - èº«ä»½è¯å·éƒ¨åˆ†è„±æ•æ˜¾ç¤º
   - æ‰‹æœºå·ä¸­é—´ä½æ•°éšè—
   - é‡è¦æ“ä½œæ—¥å¿—è®°å½•

2. **è¾“å…¥éªŒè¯**
   - æ‰€æœ‰ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯
   - SQLæ³¨å…¥é˜²æŠ¤
   - XSSæ”»å‡»é˜²æŠ¤

### æ¥å£å®‰å…¨
1. **è®¿é—®æ§åˆ¶**
   - åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶
   - æ¥å£çº§åˆ«çš„æƒé™éªŒè¯
   - æ•æ„Ÿæ“ä½œäºŒæ¬¡ç¡®è®¤

2. **è¯·æ±‚å®‰å…¨**
   - è¯·æ±‚é¢‘ç‡é™åˆ¶
   - IPç™½åå•æœºåˆ¶
   - æ¥å£è®¿é—®æ—¥å¿—

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»æ–¹å¼
- **GitHub Issues**: https://github.com/codesoldier99/UAVexam_site_backend/issues
- **é‚®ç®±æ”¯æŒ**: æŠ€æœ¯æ”¯æŒé‚®ç®±
- **æ–‡æ¡£åœ°å€**: APIåœ¨çº¿æ–‡æ¡£åœ°å€

### å¸¸è§é—®é¢˜

#### Q1: å¦‚ä½•è·å–è®¿é—®ä»¤ç‰Œï¼Ÿ
A1: é€šè¿‡ `/login` æ¥å£ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•è·å– `access_token`ã€‚

#### Q2: ä»¤ç‰Œè¿‡æœŸæ€ä¹ˆåŠï¼Ÿ
A2: éœ€è¦é‡æ–°è°ƒç”¨ç™»å½•æ¥å£è·å–æ–°çš„ä»¤ç‰Œï¼Œæˆ–ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæœºåˆ¶ã€‚

#### Q3: å¦‚ä½•æ‰¹é‡å¯¼å…¥è€ƒç”Ÿï¼Ÿ
A3: å…ˆä¸‹è½½æ¨¡æ¿æ–‡ä»¶ï¼Œå¡«å†™è€ƒç”Ÿä¿¡æ¯åé€šè¿‡ `/batch/candidates/import` æ¥å£ä¸Šä¼ ã€‚

#### Q4: äºŒç»´ç ç­¾åˆ°ä¸æˆåŠŸï¼Ÿ
A4: æ£€æŸ¥äºŒç»´ç æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼Œç¡®è®¤è€ƒè¯•æ—¶é—´æ˜¯å¦æ­£ç¡®ã€‚

#### Q5: å¦‚ä½•ä¿®æ”¹æ’æœŸæ—¶é—´ï¼Ÿ
A5: ä½¿ç”¨ `PUT /schedules/{schedule_id}` æ¥å£æ›´æ–°æ’æœŸä¿¡æ¯ã€‚

### æ›´æ–°æ—¥å¿—

#### v1.0.0 (2025-08-04)
- âœ… å®Œæ•´çš„APIæ¥å£å®ç°
- âœ… æœºæ„ç®¡ç†åŠŸèƒ½
- âœ… è€ƒç”Ÿç®¡ç†åŠŸèƒ½
- âœ… æ’æœŸç®¡ç†åŠŸèƒ½
- âœ… äºŒç»´ç ç­¾åˆ°åŠŸèƒ½
- âœ… æ‰¹é‡æ“ä½œåŠŸèƒ½
- âœ… æƒé™ç®¡ç†ç³»ç»Ÿ
- âœ… å¾®ä¿¡å°ç¨‹åºæ¥å£
- âœ… å®æ—¶é€šä¿¡åŠŸèƒ½
- âœ… å®Œæ•´çš„æµ‹è¯•å¥—ä»¶
- âœ… Dockeréƒ¨ç½²æ”¯æŒ

---

## ğŸ“‹ é™„å½•

### æ•°æ®åº“è¡¨ç»“æ„
è¯¦ç»†çš„æ•°æ®åº“è¡¨ç»“æ„è¯·å‚è€ƒé¡¹ç›®ä¸­çš„ `alembic/versions/` ç›®å½•ä¸‹çš„è¿ç§»æ–‡ä»¶ã€‚

### Postmané›†åˆ
é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `exam_site_backend.postman_collection.json` æ–‡ä»¶åŒ…å«äº†æ‰€æœ‰APIæ¥å£çš„Postmanæµ‹è¯•é›†åˆã€‚

### å¼€å‘è§„èŒƒ
- **ä»£ç é£æ ¼**: éµå¾ªPEP 8è§„èŒƒ
- **å‘½åè§„èŒƒ**: ä½¿ç”¨snake_caseå‘½å
- **æ³¨é‡Šè§„èŒƒ**: é‡è¦å‡½æ•°æ·»åŠ docstring
- **ç‰ˆæœ¬æ§åˆ¶**: ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬ç®¡ç†

---

*æœ¬æ–‡æ¡£æœ€åæ›´æ–°: 2025-08-04 10:00:00*  
*æ–‡æ¡£ç‰ˆæœ¬: v1.0.0*